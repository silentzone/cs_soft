<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>用户资料</title>
<link href="../css/jquery-ui-1.8.24.custom.css" rel="stylesheet" type="text/css" />


<script type="text/javascript" src="../js/jquery-1.8.2.min.js"></script>
<script  type="text/javascript" src="../js/jquery-ui-1.8.24.custom.min.js"></script>
<script type="text/javascript" src="../js/jquery-powerFloat-min.js"></script>
<script type="text/javascript" src="../js/artDialog.js"></script>
<script type="text/javascript" src="../js/iframeTools.js"></script>

<!-- Bootstrap -->
<link href="../plugins/bootstrap/css/bootstrap.css" rel="stylesheet" >
<!-- <link href="plugins/bootstrap/css/bootstrap-responsive.css" rel="stylesheet" > -->
<script src="../plugins/bootstrap/js/bootstrap.js"></script>
 
<!-- jquery easyui -->
<link rel="stylesheet" type="text/css" href="../plugins/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="../plugins/themes/icon.css">
<script type="text/javascript" src="../plugins/jquery.easyui.min.js"></script>

<link href="../css/page.css" rel="stylesheet" type="text/css" />


<script type="text/javascript"> 
$(function () {   
		// 用户表
  	    var $tabUserinfo = $('#table_userinfo').datagrid({  
	        url:'usergrid.json',
	        singleSelect: true,
	        striped:true,
	        columns:[[  
	        	{field:"ck",checkbox:true},
	            {field:'username',title:'用户名'
	             ,width:100,align:"center"
	        	},  
	            {field:'regdate',title:'注册日期'
	            ,width:200,align:"center"
	        	},  
	            {field:'ROLE',title:'权限'
	             ,width:200 
	        	} ,
	        	{field:'userpwd',title:'密码'
	        	,width:100 
	        	},
	        	{field:'userstatus',title:'状态'
	        	 ,width:100  
	            }  
	        ]],
	        onClickRow:function(idx,rowData) {
	        	updataRow(rowData);	
	        }
	    }); 

        // 选中用户权限表
	    var $table_userRole = $('#table_userRole').datagrid({   
	        singleSelect: true,
	        // striped:true,
	        columns:[[  
	        	{field:"ck",checkbox:true},
	            {field:'username',title:'用户'  },
	            {field:'ROLE',title:'角色'  } 
	        ]] ,
	         onSelectAll : function () {
	        	alert("没作用啊全选 ");
	        }
	    });
        
        //跟新用户权限表
  	    function updataRow(o) {
	    	var newData =  {"total":21,"rows":[]}
        	newData.rows.push(o);
        	$table_userRole.datagrid('loadData',newData);
  	    }


  	    function addRow(rowdata) { 
  	    	var Rows = $table_userRole.datagrid('getData').rows;
  	    	for(var i=0; i<Rows.length; i++) { // 去重
  	    		if ( rowdata.ROLE == Rows[i].ROLE ) { return } 
  	    	} 
  	    	$table_userRole.datagrid('appendRow',rowdata); 
  	    }

  	    function delRow(idx) {
  	    	if(idx == -1) { return }
  	    	$table_userRole.datagrid("deleteRow", idx);
  	    }

        // 权限表
	    $('#table_role').datagrid({  
	        url:'role.json',
	        // singleSelect: true,
	        // striped:true,
	        columns:[[  
	        	{field:"ck",checkbox:true},
	            {field:'ROLE',title:'用户角色'  } 
	        ]],
	        onSelectAll : function () { 	 
	        	// 全选 
	        }
	    });

	  	 $("#mov_left").click(function () { 
	    	var selectRow = $('#table_role').datagrid('getSelections');
	    	for(var i=0; i<selectRow.length; i++) {
	    		addRow(selectRow[i]);
	    	}
	    	 
	     });

	    $("#mov_right").click(function () { 
	    	var selectRow =$table_userRole.datagrid('getSelected');
	    	var selectIdx = $table_userRole.datagrid('getRowIndex',selectRow)
	    	 delRow(selectIdx);
	    	 
	     })

	    // 
	 //    var win = art.dialog.top;  
	 //    win.art.dialog.open('app/user.html',/** 弹出ART窗体*/
		// 	{   
		// 		id :"22",
		// 		title: "个人中心",	
		// 		width:830,//设置窗口宽度自动适应width
		// 		height:550,
		// 		resize:false,
		// 		lock: true,
		// 		background: '#000', // 背景色
		// 		opacity: 0.8// 透明度 
		// 	}
		// );
 
 
  
}); 
</script>
 
</head> 
<body>
<div style="width:700px; margin:0 auto;">   
	<div class="top">
	 <span class="title">用户管理</span>
	</div>
	<div class="section">
		<div class="datagrid-toolbar"> 
		 	<span class="btn btn-small" id="editUser"> <i class="icon-edit"></i>编辑</span> <span class="btn btn-small" onclick="save()"> <i class="icon-ok"></i>保存</span>         
  		</div>
		<div style="height:200px; overflow-y:auto" id="table_userinfo"> 
		</div>

		<div class="top">
			<div class="top_shadow"></div>
			<span class="title">权限分配</span>
		</div> 

		<div class="clearfix" style="text-align:center" >
			<div class="listBox"> 
				<div id="table_role"> 
				</div>	 
			</div>
			<div class="listbtn">
				<span id="mov_left" class="btn btn-mini"> <i class="icon-chevron-right"></i></span>
			 	<br/>
			 	<span id="mov_right" class="btn btn-mini"> <i class="icon-chevron-left"></i> </span> 
			</div>
			<div class="listBox"> 
				 <div id="table_userRole"> 
				</div>
			</div>
		</div>
	</div>
 
		
	</div>
</div>
</body>
 
</html>
